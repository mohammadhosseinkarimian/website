:root { --pulse-speed: 3.8s; --nav-h: 64px; }

/* Theme palette derived from --c-primary */
.theme{
  --text-1: color-mix(in srgb, white 92%, var(--c-primary) 8%);
  --text-2: color-mix(in srgb, white 78%, var(--c-primary) 22%);
  --text-3: color-mix(in srgb, white 66%, var(--c-primary) 34%);
  --surface-1: color-mix(in srgb, var(--c-primary) 18%, black 82%);
  --surface-2: color-mix(in srgb, var(--c-primary) 26%, black 74%);
  --border: color-mix(in srgb, var(--c-primary) 40%, white 60%);
  --btn-bg: linear-gradient(to bottom right, rgba(255,255,255,.08), rgba(255,255,255,.03));
}
.text-1{color:var(--text-1)} .text-2{color:var(--text-2)} .text-3{color:var(--text-3)}
.bd{border-color: color-mix(in srgb, var(--border) 35%, rgba(255,255,255,.25) 65%);}

/* Pulsing overlays */
@media (prefers-reduced-motion: reduce){ .pulse-fill,.pulse-cracks{ animation:none !important; } }
@keyframes heartbeatA{0%{opacity:0;transform:scale(1)}6%{opacity:.95;transform:scale(1.03)}14%{opacity:.25;transform:scale(1.008)}20%{opacity:1;transform:scale(1.035)}38%,100%{opacity:0;transform:scale(1)}}
@keyframes heartbeatB{0%{opacity:0;transform:scale(1)}8%{opacity:.85;transform:scale(1.02)}18%{opacity:.18;transform:scale(1.006)}26%{opacity:.9;transform:scale(1.028)}42%,100%{opacity:0;transform:scale(1)}}
.pulse-fill{
  position:fixed; inset:-10%; z-index:0; pointer-events:none;
  background:
    radial-gradient(60% 40% at 50% 45%, rgba(255,35,50,.60), rgba(255,35,50,0) 60%),
    radial-gradient(55% 35% at 15% 20%, rgba(230,10,35,.45), rgba(230,10,35,0) 55%),
    radial-gradient(55% 35% at 85% 20%, rgba(230,10,35,.40), rgba(230,10,35,0) 55%),
    radial-gradient(60% 40% at 15% 85%, rgba(255,30,45,.42), rgba(255,30,45,0) 60%),
    radial-gradient(60% 40% at 85% 85%, rgba(255,30,45,.42), rgba(255,30,45,0) 60%);
  mix-blend-mode:screen; filter:blur(12px) saturate(1.2) brightness(1.1);
  animation:heartbeatA var(--pulse-speed) cubic-bezier(.2,.9,.25,1) infinite;
}
.pulse-cracks{
  position:fixed; inset:-10%; z-index:0; pointer-events:none;
  background: radial-gradient(55% 38% at 50% 50%, rgba(255,35,55,.8), rgba(255,35,55,0) 55%);
  mix-blend-mode:screen; filter:blur(3.5px) saturate(1.4) brightness(1.2);
  animation:heartbeatB var(--pulse-speed) cubic-bezier(.2,.9,.25,1) infinite;
  -webkit-mask-image:
    repeating-linear-gradient(14deg, rgba(0,0,0,1) 0 1px, rgba(0,0,0,0) 1px 9px),
    repeating-linear-gradient(-17deg, rgba(0,0,0,1) 0 1px, rgba(0,0,0,0) 1px 11px),
    repeating-linear-gradient(92deg, rgba(0,0,0,1) 0 1px, rgba(0,0,0,0) 1px 12px);
          mask-image:
    repeating-linear-gradient(14deg, rgba(0,0,0,1) 0 1px, rgba(0,0,0,0) 1px 11px),
    repeating-linear-gradient(92deg, rgba(0,0,0,1) 0 1px, rgba(0,0,0,0) 1px 12px);
}

/* Navbar + buttons */
.navwrap{transition:background-color .35s, box-shadow .35s, backdrop-filter .35s;}
.navwrap.scrolled{background:rgba(255,255,255,0.05); backdrop-filter:blur(10px); box-shadow:0 6px 20px rgba(0,0,0,.25) inset;}
.btn{border-radius:9999px; padding:.55rem .95rem; border:1px solid var(--border); background:var(--btn-bg); color:var(--text-1); backdrop-filter:blur(2px); transition:transform .15s,border-color .2s,background .25s;}
.btn:hover{transform:translateY(-1px); border-color:color-mix(in srgb, var(--border) 70%, white 30%);}

/* === Deck of Cards === */
.deck-wrap{ display:flex; justify-content:center; }
/* make deck size/width responsive via CSS vars set by JS */
.deck{
  position:relative; isolation:isolate;
  width:min(94vw, 900px);
  height:var(--deckH, clamp(320px, 42vw, 460px));
  margin:2.5rem auto 0;
}
.deck-card-slot{
  position:absolute; top:50%; left:50%;
  width:var(--cardW, clamp(230px, 24vw, 320px));
  aspect-ratio:64/89;
  transform-origin:50% 80%;
  transform: translate3d(-50%,-50%,0) rotate(var(--angle,0deg)) translateX(var(--shift,0%));
  z-index: var(--z, 1);
  opacity:0;
  will-change: transform, opacity;
}

/* a little extra room on very small screens */
@media (max-width: 420px){
  .deck { margin-top: 1.25rem; }
  .deck-card:hover{ transform: translateY(-16px) scale(1.05); }
}

.deck-card-slot.in{
  opacity: 1;
  animation: slotRevealBounce 900ms cubic-bezier(.22,1,.22,1) both;
  animation-delay: var(--delay);
}
@keyframes slotRevealBounce{
  0%{opacity:0; transform:translate(-50%, calc(-50% + 28px)) rotate(var(--angle)) translateX(var(--shift));}
  38%{opacity:1; transform:translate(-50%, -50%) rotate(var(--angle)) translateX(var(--shift));}
  58%{transform:translate(-50%, calc(-50% - 12px)) rotate(var(--angle)) translateX(var(--shift));}
  78%{transform:translate(-50%, -50%) rotate(var(--angle)) translateX(var(--shift));}
  90%{transform:translate(-50%, calc(-50% - 6px)) rotate(var(--angle)) translateX(var(--shift));}
  100%{transform:translate(-50%, -50%) rotate(var(--angle)) translateX(var(--shift));}
}
/* card face (hover lift + shine) */
.deck-card{
  position:absolute; inset:0; border-radius:1rem; overflow:hidden;
  background: linear-gradient(to bottom right,
    color-mix(in srgb, var(--surface-2) 86%, white 14%),
    color-mix(in srgb, var(--surface-1) 88%, black 12%));
  border:1px solid var(--border);
  box-shadow: 0 22px 50px rgba(0,0,0,.36), 0 0 0 1px rgba(255,255,255,.05) inset;
  filter:saturate(1.05);
  transition: transform .35s cubic-bezier(.2,.9,.2,1), box-shadow .35s, filter .35s;
}
.deck-card::before{
  content:""; position:absolute; inset:-10% -20% -10%;
  background:linear-gradient(to top, rgba(255,255,255,0) 0%, rgba(255,255,255,.22) 45%, rgba(255,255,255,0) 55%);
  transform:translateY(110%); animation:shineUp 3.2s linear infinite; animation-delay:var(--delay);
  mix-blend-mode:screen; pointer-events:none;
}
@keyframes shineUp{0%{transform:translateY(110%);opacity:0}10%{opacity:.9}60%{opacity:.6}100%{transform:translateY(-120%);opacity:0}}
.deck-card-slot:hover{ z-index: 99999; }
.deck-card:hover{
  transform: translateY(-22px) scale(1.08);
  box-shadow: 0 30px 70px rgba(0,0,0,.45), 0 0 0 1px rgba(255,255,255,.06) inset, 0 0 40px color-mix(in srgb, var(--c-primary) 40%, transparent);
  filter:saturate(1.18) brightness(1.06);
}
/* content inside a card */
.deck-card-inner{ position:absolute; inset:0; display:flex; flex-direction:column; justify-content:flex-end; padding:1rem; gap:.35rem; }
.deck-card h3{ color:var(--text-1); font-weight:600; font-size:clamp(1rem,2.1vw,1.25rem); }
.deck-card p{ color:var(--text-3); font-size:clamp(.8rem,1.8vw,.95rem); }

/* === FLIP overlay === */
.deck-lock, .deck-lock body{ overflow:hidden; }
.deck-portal{ position:fixed; inset:0; z-index:200000; pointer-events:none; }
.deck-portal.show{ pointer-events:auto; }
.deck-scrim{ position:fixed; top:var(--nav-h,64px); left:0; right:0; bottom:0; background:transparent; }

.deck-ghost{
  position:fixed; top:0; left:0; border-radius:1rem; overflow:hidden; pointer-events:auto; z-index:200001;
  background: linear-gradient(to bottom right,
    color-mix(in srgb, var(--surface-2) 86%, white 14%),
    color-mix(in srgb, var(--surface-1) 88%, black 12%));
  border:1px solid var(--border);
  box-shadow: 0 22px 50px rgba(0,0,0,.36), 0 0 0 1px rgba(255,255,255,.05) inset;
}
.deck-ghost.transparent{ background:transparent; border-color:transparent; box-shadow:none; }
.deck-ghost.full{ position:fixed; inset:var(--nav-h,64px) 0 0 0; width:auto; height:auto; transform:none !important; border-radius:.5rem; }

/* overlay content: hidden while scaling; fade in only when FULL */
.ghost-content{ opacity:0; pointer-events:none; position:absolute; inset:var(--nav-h,64px) 0 0 0; padding:clamp(16px,3vw,32px); display:flex; flex-direction:column; gap:14px; width:100vw; height:calc(100vh - var(--nav-h,64px)); }
.deck-ghost.full .ghost-content{ opacity:1; pointer-events:auto; transition:opacity 360ms ease 120ms; }
.deck-ghost.closing .ghost-content{ opacity:0 !important; pointer-events:none !important; }

/* sample blocks inside overlay */
.ghost-grid{ display:grid; grid-template-columns:repeat(auto-fit, minmax(min(240px,100%),1fr)); gap:clamp(10px,2vw,16px); margin-top:.25rem; }
.ghost-card{ padding:clamp(12px,2vw,18px); border-radius:12px; border:1px solid var(--border);
  background:linear-gradient(to bottom right, color-mix(in srgb, var(--surface-2) 86%, white 14%), color-mix(in srgb, var(--surface-1) 88%, black 12%)); }
.ghost-card h4{ color:var(--text-1); margin-bottom:.35rem; font-weight:600; } .ghost-card p{ color:var(--text-3); }
.ghost-close{ align-self:flex-start; margin-top:.5rem; padding:.6rem 1rem; border-radius:.8rem; border:1px solid var(--border);
  background: color-mix(in srgb, var(--surface-1) 85%, var(--c-primary) 15%); color:var(--text-1); cursor:pointer; transition:transform .2s; }
.ghost-close:hover{ transform:translateY(-1px); }

/* Route fade-in utility (use on /software) */
.page-fade-in{ opacity:0; transform:translateY(10px); }
.page-fade-in.in{ opacity:1; transform:translateY(0); transition:opacity 420ms ease, transform 420ms ease; }

/* —— Route loader (covers page during redirect) —— */
/* —— Route loader in the overlay (before navigation) —— */
.route-loader{
  position:fixed; inset:0; z-index:300000; display:grid; place-items:center;
  pointer-events:none; backdrop-filter: blur(2px) saturate(1.05);
}
.loader-aura{
  position:absolute; inset:0;
  background:
    radial-gradient(50% 40% at 50% 45%, color-mix(in srgb, var(--c-primary) 60%, transparent), transparent 60%),
    radial-gradient(60% 50% at 50% 55%, rgba(0,0,0,.45), transparent 65%);
  mix-blend-mode:screen; filter: blur(16px);
  animation: auraPulse 1.4s ease-in-out infinite;
}
@keyframes auraPulse{ 0%,100%{opacity:.45} 50%{opacity:.9} }
.loader-track{
  position:relative; width:min(72vw, 560px); height:16px; border-radius:999px;
  background: linear-gradient(to right, rgba(255,255,255,.08), rgba(255,255,255,.02));
  border: 1px solid color-mix(in srgb, var(--border) 60%, white 40%);
  overflow:hidden; box-shadow: 0 10px 40px rgba(0,0,0,.35), 0 0 0 1px rgba(255,255,255,.04) inset;
}
.loader-fill{
  position:absolute; inset:0;
  background:
    repeating-linear-gradient(100deg,
      color-mix(in srgb, var(--c-primary) 90%, white 10%) 0 16px,
      color-mix(in srgb, var(--c-primary) 50%, transparent) 16px 32px
    );
  transform: translateX(-60%);
  animation: loadStripe 900ms linear infinite;
  filter: saturate(1.4) brightness(1.1);
}
@keyframes loadStripe{ to { transform: translateX(60%); } }
.loader-sparks{ position:absolute; inset:0; display:flex; gap:10px; justify-content:center; margin-top:48px; }
.loader-sparks span{
  width:8px; height:8px; border-radius:999px; background: color-mix(in srgb, var(--c-primary) 80%, white 20%);
  box-shadow: 0 0 20px color-mix(in srgb, var(--c-primary) 70%, transparent);
  animation: spark 1200ms ease-in-out infinite;
}
.loader-sparks span:nth-child(2){ animation-delay:.15s }
.loader-sparks span:nth-child(3){ animation-delay:.3s }
@keyframes spark{ 0%,100%{ transform: translateY(0) scale(.9); opacity:.7 } 50%{ transform: translateY(-10px) scale(1.1); opacity:1 } }

/* —— BODY-level veil that survives route change —— */
.route-veil{
  position:fixed; inset:0; z-index:999999; opacity:0; pointer-events:none;
  transition: opacity 260ms ease;
}
.route-veil.in{ opacity:1; }
.route-veil .veil-bg{
  position:absolute; inset:0;
  background:
    radial-gradient(1200px 800px at 30% 20%, rgba(255,255,255,0.04), transparent 60%),
    radial-gradient(1000px 700px at 70% 70%, rgba(0,0,0,0.15), transparent 65%),
    rgba(0,0,0,.9);
}
.route-veil .veil-center{
  position:absolute; inset:0; display:grid; place-items:center;
}
.route-veil.fade-out{ opacity:0; transition: opacity 420ms ease; }

/* —— Custom color input (exactly like your previous version) —— */
.color-input{
  -webkit-appearance:none; appearance:none; border:none; padding:0; margin:0;
  width: 28px; height: 28px; border-radius: 999px; cursor:pointer;
  box-shadow: 0 0 0 2px rgba(255,255,255,.15) inset, 0 6px 16px rgba(0,0,0,.3);
}
.color-input::-webkit-color-swatch{ border:none; border-radius:999px; }
.color-input::-moz-color-swatch{ border:none; border-radius:999px; }

/* Scrim shows a static snapshot of the painterly canvas during loader */
.deck-scrim.snap{
  background-image: var(--snap);
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}

/* Fade the ghost away once loader is displayed */
.deck-ghost.fade-away{
  opacity: 0;
  transition: opacity 260ms ease;
}


/* Suit shine/brightness boost for all suits (spade, heart, club, diamond) */
.deck-card svg [data-suit-shine] {
  filter: drop-shadow(0 6px 16px rgba(255,255,255,.14)) saturate(1.15) brightness(1.12);
}
/* As a fallback (for existing Spade paths without data attribute), gently brighten most paths */
.deck-card svg path {
  filter: saturate(1.06) brightness(1.06);
}
/* Extra breathing room between stacked decks */
.deck-wrap { margin-top: 5rem; }
/* ======== LUX DECK FRAMES ======== */
.lux-deck-frame{ 
  position: relative; 
  margin: clamp(6rem, 10vw, 12rem) auto;  /* distance between decks */
  padding-top: clamp(3.2rem, 6vw, 4.2rem);
  width: min(1200px, 96vw);
}
.lux-deck-inner{
  position: relative;
  border-radius: 28px;
  padding: clamp(1.4rem, 2.6vw, 2rem) clamp(.8rem, 2vw, 1.6rem) clamp(2rem, 3vw, 2.6rem);
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  box-shadow:
    0 1px 0 rgba(255,255,255,.08) inset,
    0 10px 30px rgba(0,0,0,.35);
  isolation: isolate;
}
/* gradient border using mask */
.lux-deck-inner::before{
  content:"";
  position:absolute; inset:0;
  border-radius:28px;
  padding:1.5px;
  background: linear-gradient(90deg,
    color-mix(in srgb, var(--c-primary) 40%, white 20%),
    color-mix(in srgb, var(--c-primary) 60%, black 0%) 25%,
    rgba(255,255,255,.65) 50%,
    color-mix(in srgb, var(--c-primary) 60%, black 0%) 75%,
    color-mix(in srgb, var(--c-primary) 40%, white 20%)
  );
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor;
          mask-composite: exclude;
  pointer-events:none;
  filter: drop-shadow(0 3px 14px rgba(255,255,255,.08));
}
/* centered title badge */
.lux-title-badge{
  position:absolute; left:50%; top:0;
  transform: translate(-50%, -50%);
  display:grid; gap:.3rem; justify-items:center;
  padding: .6rem 1.2rem;
  border-radius: 9999px;
  background:
    radial-gradient(120% 160% at 50% 10%, rgba(255,255,255,.12), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.02));
  border: 1px solid color-mix(in srgb, var(--c-primary) 50%, white 30%);
  box-shadow: 0 2px 10px rgba(0,0,0,.25), 0 0 0 1px rgba(255,255,255,.05) inset;
  color: color-mix(in srgb, var(--c-primary) 70%, white 30%);
  text-align:center; z-index:2;
}
.lux-title{
  margin:0;
  font-weight: 900; letter-spacing: .12em; text-transform: uppercase;
  font-size: clamp(1rem, 2.6vw, 1.35rem);
  text-shadow: 0 1px 10px rgba(0,0,0,.3);
}
.lux-flourish{ width: clamp(140px, 28vw, 220px); height: 16px; opacity:.9; }
.lux-flourish.flip{ transform: scaleY(-1); }

/* keep deck spacing tight inside frame */
.lux-deck-frame .deck-wrap{ margin-top: 0 !important; }
.lux-frame-body{ padding-top: clamp(.2rem, 1.4vw, .6rem); }

@media (max-width: 600px){
  .lux-deck-frame{ margin: clamp(4rem, 14vw, 6rem) auto; }
}
/* ===== Deck section spacing (increase distance between decks) ===== */
.deck-section{
  margin-block: clamp(6rem, 12vw, 10rem);
}

/* ===== Ornate deck heading ===== */
.deck-heading{
  width: min(1100px, 96vw);
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  justify-items: center;
  gap: clamp(.6rem, 2.4vw, 1.2rem);
}
.deck-heading.ornate{
  width: min(1200px, 96vw);
  grid-template-columns: minmax(180px,1fr) auto minmax(180px,1fr);
  gap: clamp(1rem, 3vw, 2rem);
}
.deck-heading .title{
  margin: 0;
  padding: .6rem 1.2rem;
  border-radius: 9999px;
  font-weight: 900;
  letter-spacing: .14em;
  text-transform: uppercase;
  font-size: clamp(1.1rem, 3vw, 1.6rem);
  color: color-mix(in srgb, var(--text-2) 70%, rgb(82, 80, 80) 30%);
  background:
    radial-gradient(140% 220% at 50% 20%, rgba(255,255,255,.14), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.02));
  border: 1px solid color-mix(in srgb, var(--heading-accent) 60%, white 22%);
  box-shadow: 0 2px 0 rgba(255,255,255,.08) inset, 0 12px 30px rgba(0,0,0,.35);
}
.deck-heading .ornament{
  color: var(--heading-accent);
  opacity: .95;
  display: grid; place-items: center;
}
.deck-heading .ornament .ornament-svg{
  width: clamp(180px, 30vw, 340px);
  height: clamp(48px, 8vw, 72px);
  filter: drop-shadow(0 2px 10px rgba(0,0,0,.35));
}
@media (max-width: 640px){
  .deck-heading.ornate{ grid-template-columns: auto; }
  .deck-heading .ornament{ display: none; }
}
/* ===== Page title: centered ===== */
.page-title{ text-align: center; } 

/* ===== Captions & "see publications" tint (slightly darker than primary text) ===== */
.img-caption,
.see-publications,
.see-pubs{
  color: color-mix(in srgb, var(--text-1) 78%, black 22%);
}
.see-publications:hover,
.see-pubs:hover{ color: color-mix(in srgb, var(--text-1) 88%, black 12%); }

/* ===== RevealImage: structure ===== */
/* Override: figure sizing so it never causes horizontal scroll */
/* 1) Animate the custom property used by the mask (smooth hover-in) */
@property --reveal {
  syntax: '<percentage>';
  initial-value: 0%;
  inherits: false;
}


.deck-heading + .deck-wrap {
  margin-top: clamp(1rem, 3.5vw, 1.8rem);
}

/* spacing between a deck and the NEXT heading */
.deck-wrap + .deck-heading {
  margin-top: clamp(2.25rem, 5.5vw, 3.25rem);
}

/* --- RevealImage frame (unchanged intent, ordered to win in cascade) --- */
.image-reveal{
  position: relative;
  display: grid;
  gap: .5rem;
  width: 100%;
  max-width: 100%;
  margin: 0;
  opacity: 0;
  transform: translate3d(0, 10px, 0);
  will-change: transform, opacity;
  contain: content;
}

/* Directional offset BEFORE the .in class so we can animate from it */
.image-reveal[data-dir="left"]  { transform: translate3d(-20px, 6px, 0); }
.image-reveal[data-dir="right"] { transform: translate3d( 10px, 6px, 0); }

/* Inner wrapper clips the hover-scale so caption never gets covered */
.image-reveal .img-wrap{
  position: relative;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 12px 36px rgba(0,0,0,.35);
}


/* Base styles for the two images */
.image-reveal .img{
  width: 100%;
  height: auto;
  display: block;
  border-radius: inherit;
  transform-origin: 50% 50%;
  transition: transform 1s ease;     /* 1s both ways */
  will-change: transform;
}

/* Grayscale base */
.image-reveal .img.base{
  filter: grayscale(1) saturate(0.2) contrast(1.02);
}

/* Color overlay (revealed by radial mask from center) */
.image-reveal .img.color{
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  object-fit: cover;
  border-radius: inherit;

  /* WHITE = visible, TRANSPARENT = hidden */
  --reveal: 0%;
  -webkit-mask-image: radial-gradient(circle at 50% 50%, white var(--reveal), transparent calc(var(--reveal) + 0.1%));
          mask-image: radial-gradient(circle at 50% 50%, white var(--reveal), transparent calc(var(--reveal) + 0.1%));
  transition: --reveal 1s ease, -webkit-mask-image 1s ease, mask-image 1s ease;  /* 1s hover-in/out */
}

/* Hover: subtle center scale + color reveal (stays inside frame) */
.image-reveal:hover .img       { transform: scale(1.04); }
.image-reveal:hover .img.color { --reveal: 140%; }

/* Caption + 'See publications' tint (not black) */
.image-reveal .img-caption,
.image-reveal .img-caption a,
.image-reveal .see-publications{
  color: color-mix(in srgb, var(--text-1) 88%, black 12%) !important;
}
.image-reveal .img-caption a:hover,
.image-reveal .see-publications:hover{
  color: color-mix(in srgb, var(--text-1) 95%, black 5%) !important;
}

/* 2) Bounce-in on intersection — don't override transform here, let animation drive it */
@keyframes softBounceInLeft {
  0%   { transform: translate3d(-28px, 6px, 0) scale(.985); opacity: 0; }
  60%  { transform: translate3d(  5px,-3px, 0) scale(1.01); opacity: 1; }
  85%  { transform: translate3d( -1px, 1px, 0) scale(1.00); }
  100% { transform: translate3d(  0px, 0px, 0) scale(1); }
}
@keyframes softBounceInRight {
  0%   { transform: translate3d( 28px, 6px, 0) scale(.985); opacity: 0; }
  60%  { transform: translate3d( -5px,-3px, 0) scale(1.01); opacity: 1; }
  85%  { transform: translate3d(  1px, 1px, 0) scale(1.00); }
  100% { transform: translate3d(  0px, 0px, 0) scale(1); }
}

/* When .in is added by the IO, fade in and run the directional animation */
.image-reveal.in{
  opacity: 1;
  animation-fill-mode: both;    /* keep final state, no snap-back */
}
.image-reveal.in[data-dir="left"]{
  animation: softBounceInLeft 1000ms cubic-bezier(.22,1,.22,1);
}
.image-reveal.in[data-dir="right"]{
  animation: softBounceInRight 1000ms cubic-bezier(.22,1,.22,1);
}
/* Center the image captions */
.image-reveal .img-caption{
  text-align: center;
  justify-self: center;
  margin-inline: auto;
  display: block;
}
/* ===== Research Assistant: Skills ===== */
.skills-section { width: min(1100px, 96vw); margin-inline: auto; }

.skills-grid{
  display: grid;
  grid-template-columns: repeat(4, minmax(140px, 1fr));
  gap: clamp(.9rem, 2.4vw, 1.25rem);
  justify-items: center;
}

@media (max-width: 980px){
  .skills-grid{ grid-template-columns: repeat(3, minmax(140px, 1fr)); }
}
@media (max-width: 640px){
  .skills-grid{ grid-template-columns: repeat(2, minmax(120px, 1fr)); }
}

.skill-orb{
  width: clamp(140px, 22vw, 200px);
  aspect-ratio: 1 / 1;
  border-radius: 999px;
  background:
    linear-gradient(180deg,
      color-mix(in srgb, var(--surface-2) 80%, rgba(255,255,255,.16) 20%),
      color-mix(in srgb, var(--surface-1) 86%, rgba(0,0,0,0) 14%)
    );
  border: 1px solid var(--border);
  box-shadow: 0 12px 30px rgba(0,0,0,.30), 0 0 0 1px rgba(255,255,255,.04) inset;
  display: grid;
  place-items: center;
  transition: transform 1s ease, box-shadow .35s ease, filter .35s ease;
  will-change: transform;
}

.skill-orb:hover{
  transform: scale(1.06);
  box-shadow: 0 18px 44px rgba(0,0,0,.38), 0 0 0 1px rgba(255,255,255,.06) inset;
  filter: saturate(1.06) brightness(1.03);
}

.skill-inner{
  display: flex;
  align-items: center;
  gap: .6rem;
  max-width: 80%;
}

.skill-icon{
  font-size: clamp(1.2rem, 3.5vw, 1.8rem);
  color: color-mix(in srgb, var(--text-1) 92%, white 8%);
  flex: 0 0 auto;
}

.skill-label{
  color: var(--text-1);
  font-size: clamp(.9rem, 2.1vw, 1rem);
  line-height: 1.2;
}
/* === Themed scrollbars (track lighter than bg, thumb lighter than track) === */
/* Fallbacks (will be overwritten from JS below) */
:root{
  --scroll-track: #1a1a1a;
  --scroll-thumb: #2a2a2a;
  --scroll-thumb-hover: #3a3a3a;
  --scroll-corner: #222;
}

/* Firefox */
html { scrollbar-width: thin; scrollbar-color: var(--scroll-thumb) var(--scroll-track); }

/* WebKit (Chrome/Edge/Safari) — target the viewport scrollbars */
html::-webkit-scrollbar         { width: 12px; height: 12px; }
html::-webkit-scrollbar-track   { background: var(--scroll-track); }
html::-webkit-scrollbar-thumb   { background: var(--scroll-thumb); border-radius: 999px; border: 2px solid var(--scroll-track); }
html::-webkit-scrollbar-thumb:hover { background: var(--scroll-thumb-hover); }
html::-webkit-scrollbar-corner  { background: var(--scroll-corner); }


/* ==== Realistic paper burn (Top-Left ➜ Bottom-Right) ===================== */
/* Flame stays at the burn head (TL), flickers, throws smoke/embers, and a ragged
   edge “eats” the page diagonally. The route swaps when the burnPath ends. */

.burn-veil{
  position: fixed;
  inset: 0;
  z-index: 999999;
  pointer-events: none;

  /* burn head position + radius */
  --x: 0%;
  --y: 0%;
  --r: 6%;

  /* color palette */
  --ember: rgba(255,160,60,.25);
  --char1: rgba(70,28,8,.85);
  --char2: rgba(0,0,0,.96);

  /* darken page like scorched paper (without turning it into a flashlight) */
  background:
    radial-gradient(120% 120% at 50% 50%,
      rgba(255,190,120,.10) 0%,
      rgba(120,48,12,.45) 60%,
      rgba(0,0,0,.86) 80%) ;
  mix-blend-mode: multiply;

  /* RAGGED HOLE MASK
     - Base: radial hole centered at (--x,--y)
     - Noise edge: “tears” the rim so it’s not a perfect circle
  */
  /* SVG noise for jagged edge (supported in modern Chrome/Edge/Safari/FF) */
  --noise: url("data:image/svg+xml;utf8,\
  <svg xmlns='http://www.w3.org/2000/svg' width='240' height='240' viewBox='0 0 240 240'>\
    <filter id='n'><feTurbulence baseFrequency='0.95' numOctaves='2' seed='7' type='fractalNoise'/><feComponentTransfer><feFuncA type='table' tableValues='0 0 0 .2 .7 1 1 1 1'/></feComponentTransfer></filter>\
    <rect width='100%%' height='100%%' filter='url(#n)' fill='black'/>\
  </svg>");

  /* Compose base hole + noisy rim */
  -webkit-mask-image:
      radial-gradient(circle at var(--x) var(--y),
        transparent calc(var(--r) - 1.0%),
        black      calc(var(--r) + 0.0%)),
      var(--noise);
          mask-image:
      radial-gradient(circle at var(--x) var(--y),
        transparent calc(var(--r) - 1.0%),
        black      calc(var(--r) + 0.0%)),
      var(--noise);

  /* keep the noise glued to the hole edge and drift a bit for life */
  -webkit-mask-repeat: no-repeat, repeat;
          mask-repeat: no-repeat, repeat;
  -webkit-mask-size: 100% 100%, 240px 240px;
          mask-size: 100% 100%, 240px 240px;
  -webkit-mask-position: 0 0, calc(var(--x)) calc(var(--y));
          mask-position: 0 0, calc(var(--x)) calc(var(--y));
}


canvas { image-rendering: auto; }
.site-footer{
  border-top: 1px solid color-mix(in srgb, var(--border) 65%, transparent);
  padding-block: clamp(1rem, 3vw, 2rem);
}

.footer-grid{
  display:grid;
  grid-template-columns: 1fr;
  gap: clamp(1rem, 3vw, 1.5rem);
  align-items:start;
}
@media (min-width: 768px){
  .footer-grid{
    grid-template-columns: 1.1fr .9fr .9fr 1fr; /* brand | social | reference | contact */
    gap: clamp(1rem, 3vw, 2rem);
  }
}

.footer-title{
  color: var(--text-2);
  font-weight: 800;
  letter-spacing: .08em;
  text-transform: uppercase;
  font-size: .8rem;
  margin: -0.5rem 0 0.5rem;
}

.footer-muted{
  color: var(--text-3);
  font-size: clamp(.9rem, 2vw, 1rem);
  line-height: 1.5;
  margin: 0;
}


/* Android Chrome fast-scroll white flash fix for the footer */
.site-footer{
  /* 1) make it non-transparent (keeps your look but removes “white flash”) */
  background: linear-gradient(
    to top,
    color-mix(in srgb, var(--c-primary) 4%, #0000007d 96%) 0%,
    color-mix(in srgb, var(--c-primary) 4%, #00000048 96%) 100%
  );

  /* 2) avoid backdrop artifacts */
  -webkit-backdrop-filter: none;
  backdrop-filter: none;

  /* 3) force a stable compositing layer during momentum scroll */
  transform: translateZ(0);
  will-change: transform;
  contain: paint;
  isolation: isolate; /* prevents blend/overlay from affecting ancestors */
}

/* If you have a separate .footer-grid with a transparent bg, keep it transparent */
.footer-grid{ background: transparent; }


.brand-icon{
  width: 48px; height: 48px;
  display: inline-grid; place-items: center;
  color: var(--text-1);
  border-radius: 14px;
  box-shadow: 0 8px 24px rgba(0,0,0,.28), inset 0 0 0 1px color-mix(in srgb, var(--border) 55%, transparent);
  background: var(--btn-bg);
}

/* Social icons row */
.social-list{ display:flex; gap:.75rem; flex-wrap:wrap; align-items:center; }
.social-link{
  display:inline-flex; align-items:center; gap:.5rem;
  color: var(--text-2); text-decoration:none;
}
.social-link .icon{
  width: 28px; height: 28px;
  transition: transform .25s ease, filter .25s ease;
}
.social-link:hover .icon{
  transform: translateY(-2px) scale(1.12);
  filter: drop-shadow(0 6px 12px rgba(0,0,0,.35));
}

/* Mail row */
.mail-row{ display:flex; align-items:center; gap:.5rem; }
.mail-icon{
  width: 22px; height: 22px; flex:0 0 auto; color: var(--text-2);
}
/* Brand row with logo + text to the right */
.brand-row{
  display:flex;
  align-items:center;
  gap: clamp(.6rem, 2.4vw, 1rem);
  color: var(--text-1);
}

.brand-logo{
  width: clamp(42px, 5.5vw, 56px);
  height: auto;
  display: block;
  /* subtle depth to match your UI */
  filter: drop-shadow(0 6px 16px rgba(0,0,0,.25));
}
@media (max-width: 768px){
  /* RevealImage uses these classes across pages */
  .image-reveal,
  .reveal-io{
    width: min(92vw, 520px) !important;  /* override w-full */
    margin-inline: auto !important;       /* center in its column */
    display: block;
  }
  /* Center any inner figure/caption */
  .image-reveal .img-caption,
  .reveal-io .img-caption{
    text-align: center;
    margin-inline: auto;
  }
}

/* Desktop/tablet: keep your original left/right alignment (from markup) */
@media (min-width: 769px){
  .image-reveal,
  .reveal-io{
    width: auto;        /* inherit existing sizing */
    margin-inline: 0;   /* let your md:justify-self-* take over */
  }
}

/* base: use current text color for the logo stroke */
.brand-stroke { stroke: currentColor; transition: stroke .3s ease; }

/* on hover of the row, swap to gradient stroke */
.group:hover .brand-stroke { stroke: url(#mkGrad); }

/* optional: respect reduced motion (only color change, no scale) */
@media (prefers-reduced-motion: reduce) {
  .brand-logo { transition: none; }
}
.group:hover .brand-logo { filter: drop-shadow(0 0 6px rgba(58,104,255,.35)); }

/* === Diagonal theme sweep (TR ➜ BL) =================================== */
#page-shell { position: relative; z-index: 0; }   /* sweep anchors here */

.theme-sweep {
  position: absolute;       /* <— anchor to #page-shell, not the whole window */
  inset: 0;
  pointer-events: none;
  z-index: 50;              /* over content + background, under any modals you may open */
  --sweep: var(--c-primary, #0B0F1A);

  /* Wide diagonal band carrying the INCOMING color */
  background:
    linear-gradient(
      225deg,  /* top-right to bottom-left */
      color-mix(in srgb, var(--sweep) 85%, white 15%) 0%,
      color-mix(in srgb, var(--sweep) 85%, white 15%) 50%,
      transparent 64%
    );
  background-size: 200% 200%;
  background-position: 100% 0%;   /* start at top-right */

  mix-blend-mode: color;          /* tint hue+saturation (clearer across dark bg) */

  /* longer, smoother */
  animation: themeSweep 1600ms ease forwards, themeSweepFade 1600ms ease forwards;
  filter: saturate(1.08) brightness(1.04);
}

@keyframes themeSweep { to { background-position: 0% 100%; } }  /* ends bottom-left */
@keyframes themeSweepFade {
  0%   { opacity: .00; }
  10%  { opacity: .85; }
  85%  { opacity: .85; }
  100% { opacity: 0; }
}

/* --- iOS Safari white-background fix for blurred/fixed header items --- */
@supports (-webkit-touch-callout: none) {
  /* iOS only: avoid backdrop artifacts on the fixed nav */
  .navwrap.scrolled {
    /* remove blur on iOS and use a translucent dark bg instead */
    -webkit-backdrop-filter: none !important;
    backdrop-filter: none !important;
    background: rgba(0, 0, 0, 0.32) !important;
  }

  /* kill backdrop blur on tiny UI chips (logo tile, etc.) */
  .ios-no-backdrop {
    -webkit-backdrop-filter: none !important;
    backdrop-filter: none !important;
    background: transparent !important; /* or rgba(0,0,0,.18) if you want a tint */
  }
}
